const spinner={show:function(){$(".spinner").show()},hide:function(){$(".spinner").hide()}};function toastrForm(e){0==e.status?toastr.error(e.message,e.title):toastr.success(e.message,e.title)}function trashImage(e,t,r){if(t){let a=JSON.parse($("#"+t).val()),s=a.indexOf(r);a.splice(s,1),$("#"+t).val(JSON.stringify(a))}e.closest(".media").remove()}function submitForm(e,t,r,a){r=r||"",a=a||function(){},t=t||"";let s=document.getElementById(e),o="";if(s){(o=s.action)||(o=window.location.pathname);let i={type:"POST",url:o,cache:!1,beforeSend:function(){spinner.show()},success:function(e){if(toastrForm(e),a(e),spinner.hide(),1==e.status)""!=r&&(location.href=r);else{let t=$(".arr0").length>0,s=[];if(Object.prototype.hasOwnProperty.call(e,"errors")&&(s=e.errors),s&&s.length)for(let o=0;o<s.length;o++){let i=s[o].path,n=s[o].message;if(t){let l=$("#"+i).closest(".tab-pane").attr("id");$("."+l+" > button").click()}$("#"+i).closest("div").addClass("has-validation").append(` <div id="validation${i}" class="invalid-feedback">${n}.</div>`),$("#"+i).addClass("is-invalid"),setTimeout(function(){$("#"+i).closest("div").removeClass("has-validation"),$("#validation"+i).remove(),$("#"+i).removeClass("is-invalid")},5e3)}}},error:function(e,t){if(0==e.status)toastr.error("You are offline!!\n Please Check Your Network.","Error!");else if(404==e.status)toastr.error("Requested URL not found.","Error "+e.status);else if(500==e.status){let r=e.responseText,a="documents";$(".div"+a).addClass("has-error"),$(".div"+a).append('<div class="help-block">'+$(r).first().text()+"</div>"),toastr.error(""+$(r).first().text(),"Error Image"),setTimeout(function(){location.href=""},2e3)}else"parsererror"==t?toastr.error("Error.\nParsing JSON Request failed.","Error!"):"timeout"==t?toastr.error("Request Time out.","Error!"):toastr.error("Unknow Error.\n"+e.responseText,"Error!")}};s.onsubmit=function(r,a){r.preventDefault(),$(".help-block").remove(),$(".has-error").removeClass("");let o=$(s);if(o.find(".tinymce").length&&tinyMCE.triggerSave(),o.find('input[type="checkbox"]').each(function(){let e=$(this);!0==e.is(":checked")?e.attr("value","1"):(e.prop("checked",!0),e.attr("value","0"),setTimeout(function(){e.prop("checked",!1)},2e3))}),t){if(t instanceof Array)for(var n=0;n<t.length;n++)$("#"+t[n]).remove();else $("#"+t).remove()}let l=new FormData($("#"+e)[0]);i.processData=!1,i.contentType=!1,i.data=l,$.ajax(i)}}}function onSubmitForm(e,t){t=t||toastrForm();let r=document.getElementById(e),a=r.attr("action");if(a||(a=window.location.pathname),r){let s={method:"POST",url:a,cache:!1,beforeSend:function(){spinner.show()},success:function(e){if(spinner.hide(),toastrForm(e),t(e),1!=e.status){let r=$(".arr0").length>0,a=[];if(Object.prototype.hasOwnProperty.call(e,"errors")&&(a=e.errors),a&&a.length)for(let s=0;s<a.length;s++){let o=a[s].path,i=a[s].message;if(r){let n=$("#"+o).closest(".tab-pane").attr("id");$("."+n+" > button").click()}$("#"+o).closest("div").addClass("has-validation").append(` <div id="validation${o}" class="invalid-feedback">${i}.</div>`),$("#"+o).addClass("is-invalid"),setTimeout(function(){$("#"+o).closest("div").removeClass("has-validation"),$("#validation"+o).remove(),$("#"+o).removeClass("is-invalid")},5e3)}}},error:function(e,t){if(0==e.status)toastr.error("You are offline!!\n Please Check Your Network.","Error!");else if(404==e.status)toastr.error("Requested URL not found.","Error "+e.status);else if(500==e.status){let r=e.responseText,a="documents";$(".div"+a).addClass("has-error"),$(".div"+a).append('<div class="help-block">'+$(r).first().text()+"</div>"),toastr.error(""+$(r).first().text(),"Error Image"),setTimeout(function(){location.href=""},2e3)}else"parsererror"==t?toastr.error("Error.\nParsing JSON Request failed.","Error!"):"timeout"==t?toastr.error("Request Time out.","Error!"):toastr.error("Unknow Error.\n"+e.responseText,"Error!")}};r.onsubmit=function(t,a){t.preventDefault(),$(".help-block").remove(),$(".has-error").removeClass("");$(r).find('input[type="checkbox"]').each(function(){let e=$(this);!0==e.is(":checked")?e.attr("value","1"):(e.prop("checked",!0),e.attr("value","0"),setTimeout(function(){e.prop("checked",!1)},2e3))});let o=new FormData($("#"+e)[0]);s.processData=!1,s.contentType=!1,s.data=o,$.ajax(s)}}}function loadFile(e,t=""){let r=e.value;var a=r.replace(/^.*[\\\/]/,"");let s=$(e),o=$(this).data("width")||"300",i=s.parent().get(0).tagName,n=r.substring(r.lastIndexOf(".")+1).toLowerCase();if(e.files&&e.files[0]&&("gif"==n||"png"==n||"jpeg"==n||"jpg"==n||"bmp"==n||"svg"==n||"webp"==n)){let l=new FileReader;l.onload=function(e){"TD"==i?s.closest("td").find("img.mb-3").attr("src",e.target.result).attr("width",`${o}px`).addClass("boxy"):(s.closest("div").find("img.mb-3").attr("src",e.target.result).attr("width",`${o}px`).addClass("boxy"),s.closest("div").find("a.text-success").html(` ${a}`))},l.readAsDataURL(e.files[0])}else{let c="file.png";"docx"==n||"doc"==n?c="word.png":"xls"==n||"xlsx"==n?c="excel.png":"pdf"==n?c="pdf.png":"ppt"==n||"pptx"==n?c="ppt.png":"txt"==n?c="txt.png":"zip"==n?c="zip.jpg":"rar"==n?c="rar.jpg":"rar"==n&&(c="file.png"),"TD"==i?s.closest("td").find("img.mb-3").attr("src",`/img/${c}`).attr("height","45px").attr("width","45px").addClass("boxy-small"):(s.closest("div").find("img.mb-3").attr("src",`/img/${c}`).attr("height","45px").attr("width","45px").addClass("boxy-small"),s.closest("div").find("a.text-success").html(` ${a}`))}}function fileAttribute(e){"use strict";let t=(e=e.toLowerCase()||"").split(".").pop(),r={};return r.ext=t,["jpg","jpeg","png","webp","bmp","tif","gif","png","svg","jpeg"].includes(t)?r.type="image":r.type="file",r}function removeimage(e){let t=$(e);t.parents().eq(1).find('input[type="file"]').attr("value","").attr("type","text"),t.parents().closest(".isfile").remove()}function viewFile(e,t){"use strict";let r=e+t,a="";return"image"==Util.fileAttribute(r).type?'<img src="'+r+'" width="300px">':'<a href="'+r+'">'+t+"</a>"}function gridItems(e){return e.map(function(e){let t={};return t.id=e.id?'"'+e.id+'"':"",t.name=e.name,t})}function gridValues(e,t){let r="";if((e=JSON.parse(e=e||"[]")||[]).length){for(var a=0;a<e.length;a++)r+=" "+t[e[a]]+",";r=r.slice(0,-1)}return r}function ajaxCall(e,t,r,a){a=a||function(){};let s={type:e,url:t,cache:!1,headers:{"CSRF-Token":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},beforeSend:function(){spinner.show()}};r&&(s.data=r),s.success=function(e){spinner.hide(),a(e)},$.ajax(s)}function ajaxPost(e,t,r){ajaxCall("POST",e,t,r)}function ajaxGet(e,t,r){ajaxCall("GET",e,t,r)}function ajaxPut(e,t,r){ajaxCall("PUT",e,t,r)}function ajaxDelete(e,t,r){ajaxCall("DELETE",e,t,r)}function formatNumber(e){return(e=e||"").toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function formatString(e){return(e=JSON.parse(e)||[]).join(", ")}function fallbackCopyTextToClipboard(e){let t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{let r=document.execCommand("copy");console.log("Fallback: Copying text command was "+(r?"successful":"unsuccessful"))}catch(a){console.error("Fallback: Oops, unable to copy",a)}document.body.removeChild(t)}function copyToClipboard(e){e&&(navigator.clipboard?navigator.clipboard.writeText(e):fallbackCopyTextToClipboard(e),toastr.info("Copied Text "+e))}function chains(e,t,r,a,s,o=0){ajaxPost(`/${t}/chains`,{column:a,table:t,id:$("#"+e).val(),name:s,target:r,currentValue:o},function(e){$("#"+r).html(e[r])})}function titlerange(e){$(e).attr("title",$(e).val()||"0")}$(".typeahead-remove").on("click",function(){$(".jstypeahead").val("");let e=$(this).data("element");$("#"+e).val(""),$(".kilo").removeClass("alert").removeClass("alert-block").removeClass("alert-success"),$(".kilo").html(""),$(".klform").removeClass("has-success").removeClass("has-feedback"),$("#total").val("")}),$("body").on("click",".can-copy",function(){copyToClipboard($(this).data("name"))});

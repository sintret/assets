const spinner={show:function(){$(".spinner").show()},hide:function(){$(".spinner").hide()}};function toastrForm(e){toastr.options.closeDuration=3e3,0==e.status?toastr.error(e.message,e.title):toastr.success(e.message,e.title)}function trashImage(e,t,r){if(t){let a=JSON.parse($("#"+t).val()),o=a.indexOf(r);a.splice(o,1),$("#"+t).val(JSON.stringify(a))}e.closest(".media").remove()}function submitForm(e,t,r,a){r=r||"",a=a||function(){},t=t||"";let o=document.getElementById(e),n="";if(o){(n=o.action)||(n=window.location.pathname);let i={type:"POST",url:n,cache:!1,beforeSend:function(){spinner.show()},success:function(e){if(toastrForm(e),a(e),spinner.hide(),1==e.status)""!=r&&(location.href=r);else{let t=$(".arr0").length>0,o=[];if(Object.prototype.hasOwnProperty.call(e,"errors")&&(o=e.errors),o&&o.length)for(let n=0;n<o.length;n++){let i=o[n].path,l=o[n].message;if(t){let c=$("#"+i).closest(".tab-pane").attr("id");$("."+c+" > button").click()}$("#"+i).closest("div").addClass("has-validation").append(` <div id="validation${i}" class="invalid-feedback">${l}.</div>`),$("#"+i).addClass("is-invalid"),setTimeout(function(){$("#"+i).closest("div").removeClass("has-validation"),$("#validation"+i).remove(),$("#"+i).removeClass("is-invalid")},5e3)}}},error:function(e,t){if(0==e.status)toastr.error("You are offline!!\n Please Check Your Network.","Error!");else if(404==e.status)toastr.error("Requested URL not found.","Error "+e.status);else if(500==e.status){let r=e.responseText,a="documents";$(".div"+a).addClass("has-error"),$(".div"+a).append('<div class="help-block">'+$(r).first().text()+"</div>"),toastr.error(""+$(r).first().text(),"Error Image"),setTimeout(function(){location.href=""},2e3)}else"parsererror"==t?toastr.error("Error.\nParsing JSON Request failed.","Error!"):"timeout"==t?toastr.error("Request Time out.","Error!"):toastr.error("Unknow Error.\n"+e.responseText,"Error!")}};o.onsubmit=function(r,a){r.preventDefault(),$(".help-block").remove(),$(".has-error").removeClass("");let n=$(o);if(n.find(".tinymce").length&&tinyMCE.triggerSave(),n.find('input[type="checkbox"]').each(function(){let e=$(this);!0==e.is(":checked")?e.attr("value","1"):(e.prop("checked",!0),e.attr("value","0"),setTimeout(function(){e.prop("checked",!1)},2e3))}),t){if(t instanceof Array)for(var l=0;l<t.length;l++)$("#"+t[l]).remove();else $("#"+t).remove()}let c=new FormData($("#"+e)[0]);i.processData=!1,i.contentType=!1,i.data=c,$.ajax(i)}}}function jqueryForm(e,t){t=t||toastrForm();let r=e.attr("action");r||(r=window.location.pathname);let a={method:"POST",url:r,cache:!1,beforeSend:function(){spinner.show()},success:function(e){toastrForm(e),t(e),spinner.hide()}};$(".help-block").remove(),$(".has-error").removeClass(""),a.data=e.serializeArray(),$.ajax(a)}function goForm(e,t,r){t=t||"",r=r||function(){};let a=document.getElementById(e);if(a){let o=a.action;o||(o=window.location.pathname),a.onsubmit=function(e){e.preventDefault(),$(".help-block").remove(),$(".has-error").removeClass(""),o=window.location.pathname,$.ajax({type:"POST",url:o,data:$(this).serialize(),success:function(e){if(toastrForm(e),r(e),1==e.status)""!=t&&(location.href=t);else{let a=[];if(Object.prototype.hasOwnProperty.call(e,"errors")&&(a=e.errors),a&&a.length)for(let o=0;o<a.length;o++){let n=a[o].path,i=a[o].message;$(".div"+n).addClass("has-error"),$(".div"+n).append('<div class="help-block">'+i+"</div>"),toastr.error(i,"Error!")}}},error:function(e,t){0==e.status?toastr.error("Server is offline!!\n Please Come back in few minutes.","Error!"):404==e.status?toastr.error("Requested URL not found.","Error "+s.status):500==e.status?toastr.error("Internal Server Error.","Error "+s.status):"parsererror"==t?toastr.error("Error.\nParsing JSON Request failed.","Error!"):"timeout"==t?toastr.error("Request Time out.","Error!"):toastr.error("Unknow Error.\n"+e.responseText,"Error!")}})}}}var fileImage=document.getElementById("images_select"),fileElem=document.getElementById("images");function regularCallback(e){1==e.status&&toastr.success("Successfully Saved!")}function removeimage(e){let t=$(e);t.parents().parents().find('input[type="file"]').attr("data-test","test").attr("value","").attr("type","text"),t.parents().closest(".isfile").remove()}function loadFile(e,t=""){let r=e.value;var a=r.replace(/^.*[\\\/]/,"");let o=$(e),n=$(this).data("width")||"300",i=o.parent().get(0).tagName,l=r.substring(r.lastIndexOf(".")+1).toLowerCase();if(e.files&&e.files[0]&&("gif"==l||"png"==l||"jpeg"==l||"jpg"==l||"bmp"==l||"svg"==l||"webp"==l)){let c=new FileReader;c.onload=function(e){"TD"==i?o.closest("td").find("img.mb-3").attr("src",e.target.result).attr("width",`${n}px`).addClass("boxy"):(o.closest("div").find("img.mb-3").attr("src",e.target.result).attr("width",`${n}px`).addClass("boxy"),o.closest("div").find("a.text-success").html(` ${a}`))},c.readAsDataURL(e.files[0])}else{let u="file.png";"docx"==l||"doc"==l?u="word.png":"xls"==l||"xlsx"==l?u="excel.png":"pdf"==l?u="pdf.png":"ppt"==l||"pptx"==l?u="ppt.png":"txt"==l?u="txt.png":"zip"==l?u="zip.jpg":"rar"==l?u="rar.jpg":"rar"==l&&(u="file.png"),"TD"==i?o.closest("td").find("img.mb-3").attr("src",`/img/${u}`).attr("height","45px").attr("width","45px").addClass("boxy-small"):(o.closest("div").find("img.mb-3").attr("src",`/img/${u}`).attr("height","45px").attr("width","45px").addClass("boxy-small"),o.closest("div").find("a.text-success").html(` ${a}`))}}function fileAttribute(e){"use strict";let t=(e=e.toLowerCase()||"").split(".").pop(),r={};return r.ext=t,Util.in_array(t,["jpg","jpeg","png","webp","bmp","tif","gif","png","svg","jpeg"])?r.type="image":r.type="file",r}function viewFile(e,t){"use strict";let r=e+t,a="";return"image"==Util.fileAttribute(r).type?'<img src="'+r+'" width="300px">':'<a href="'+r+'">'+t+"</a>"}function gridItems(e){return e.map(function(e){let t={};return t.id=e.id?'"'+e.id+'"':"",t.name=e.name,t})}function gridValues(e,t){let r="";if((e=JSON.parse(e=e||"[]")||[]).length){for(var a=0;a<e.length;a++)r+=" "+t[e[a]]+",";r=r.slice(0,-1)}return r}function ajaxCall(e,t,r,a){a=a||function(){};let o={type:e,url:t,cache:!1,headers:{"CSRF-Token":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},beforeSend:function(){spinner.show()}};r&&(o.data=r),o.success=function(e){spinner.hide(),a(e)},$.ajax(o)}function ajaxPost(e,t,r){ajaxCall("POST",e,t,r)}function ajaxGet(e,t,r){ajaxCall("GET",e,t,r)}function ajaxPut(e,t,r){ajaxCall("PUT",e,t,r)}function ajaxDelete(e,t,r){ajaxCall("DELETE",e,t,r)}function formatNumber(e){return(e=e||"").toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function formatString(e){return(e=JSON.parse(e)||[]).join(", ")}function fallbackCopyTextToClipboard(e){let t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{let r=document.execCommand("copy");console.log("Fallback: Copying text command was "+(r?"successful":"unsuccessful"))}catch(a){console.error("Fallback: Oops, unable to copy",a)}document.body.removeChild(t)}function copyToClipboard(e){e&&(navigator.clipboard?navigator.clipboard.writeText(e):fallbackCopyTextToClipboard(e),toastr.info("Copied Text "+e))}function chains(e,t,r,a,o,n=0){ajaxPost(`/${t}/chains`,{column:a,table:t,id:$("#"+e).val(),name:o,target:r,currentValue:n},function(e){$("#"+r).html(e[r])})}function titlerange(e){$(e).attr("title",$(e).val()||"0")}fileImage&&fileImage.addEventListener("click",function(e){fileElem&&fileElem.click(),e.preventDefault()},!1),$(".typeahead-remove").on("click",function(){$(".jstypeahead").val("");let e=$(this).data("element");$("#"+e).val(""),$(".kilo").removeClass("alert").removeClass("alert-block").removeClass("alert-success"),$(".kilo").html(""),$(".klform").removeClass("has-success").removeClass("has-feedback"),$("#total").val("")}),$("body").on("click",".can-copy",function(){copyToClipboard($(this).data("name"))}),$(".open_advancesearch").on("click",function(){$(".advancesearch").toggle()});
